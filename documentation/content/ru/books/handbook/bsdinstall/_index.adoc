//
// The FreeBSD Russian Documentation Project
//
// Original EN revision: SVN 53975
//

---
title: Глава 3. Установка FreeBSD версий 9.X и более поздних
part: Часть I. В начале
prev: books/handbook/install
next: books/handbook/basics
showBookMenu: true
weight: 5
path: "/books/handbook/"
---

[[bsdinstall]]
= Установка FreeBSD
:doctype: book
:toc: macro
:toclevels: 1
:icons: font
:sectnums:
:sectnumlevels: 6
:sectnumoffset: 3
:partnums:
:source-highlighter: rouge
:experimental:
:images-path: books/handbook/bsdinstall/

ifdef::env-beastie[]
ifdef::backend-html5[]
:imagesdir: ../../../../images/{images-path}
endif::[]
ifndef::book[]
include::shared/authors.adoc[]
include::shared/mirrors.adoc[]
include::shared/releases.adoc[]
include::shared/attributes/attributes-{{% lang %}}.adoc[]
include::shared/{{% lang %}}/teams.adoc[]
include::shared/{{% lang %}}/mailing-lists.adoc[]
include::shared/{{% lang %}}/urls.adoc[]
toc::[]
endif::[]
ifdef::backend-pdf,backend-epub3[]
include::../../../../../shared/asciidoctor.adoc[]
endif::[]
endif::[]

ifndef::env-beastie[]
toc::[]
include::../../../../../shared/asciidoctor.adoc[]
endif::[]

[[bsdinstall-synopsis]]
== Краткий обзор

Имеется несколько различных вариантов распространения FreeBSD, предназначенных для последующего запуска, зависящих от определённых условий.
Эти варианты таковы:

* Образы виртуальных машин, которые сгружаются и импортируются в виртуальное окружение на ваш выбор. Эти образы могут быть сгружены со страницы link:https://www.freebsd.org/where.html[Скачивания FreeBSD]. Имеются образы для KVM ("qcow2"), VMWare ("vmdk") и Hyper-V ("vhd"), а также прямые образы устройств, поддерживаемые повсеместно. Они не являются образами для проведения установки, но представляют собой преднастроенные ("уже установленные") экземпляры, готовые к запуску и выполнению шагов после установки.
* Образы виртуальных машин, доступные в сервисах link:https://aws.amazon.com/marketplace/pp/B07L6QV354[AWS Marketplace] компании Amazon, link:https://azuremarketplace.microsoft.com/en-us/marketplace/apps?search=freebsd&amp;page=1[Microsoft Azure Marketplace] и link:https://console.cloud.google.com/marketplace/details/freebsd-cloud/freebsd-12[Google Cloud Platform], предназначенные для запуска в рамках соответствующих хостинговых сервисов этих компаний. Для получения дополнительной информации о разворачивании FreeBSD в сервисе Azure, пожалуйста, обратитесь к соответствующей главе в link:https://docs.microsoft.com/en-us/azure/virtual-machines/linux/freebsd-intro-on-azure[Документации по Azure].
* Образы карт памяти SD для таких интегрированных систем, как Raspberry Pi или BeagleBone Black. Они могут быть сгружены со страницы link:https://www.freebsd.org/where.html[Скачивания FreeBSD]. Эти файлы должны быть распакованы и записаны как прямой образ на карту памяти SD, с которой затем будет загружаться система.
* Установочные образы для установки FreeBSD на жёсткий диск обычного настольного компьютера, ноутбука или сервера.

Остаток этой главы посвящён четвёртому варианту и описывает, каким образом установить FreeBSD при помощи программы установки с текстовым интерфейсом, которая называется bsdinstall.

В целом инструкции по установке в этой главе предназначены для архитектур i386(TM) и AMD64.
Там, где это применимо, будут даны указания для других платформ.
Между работой программы установки и тем, что показано здесь, могут быть незначительные расхождения, так что используйте эту главу как общее руководство, а не точную инструкцию.

[NOTE]
====
Пользователей, которые предпочитают устанавливать FreeBSD при помощи графической программы установки, может заинтересовать программа pc-sysinstall, используемая для установки Проектом TrueOS.
Она может использоваться как установки либо рабочей станции с графической оболочкой (TrueOS), либо версии FreeBSD с командной строкой.
Для уточнения деталей обратитесь к Руководству пользователя TrueOS (link:https://www.trueos.org/handbook/trueos.html[https://www.trueos.org/handbook/trueos.html]).
====

После прочтения этой главы вы будете знать:

* Минимальные аппаратные требования и архитектуры, поддерживаемые FreeBSD.
* Как создавать установочные носители для FreeBSD.
* Как запустить bsdinstall.
* Вопросы, задаваемые утилитой bsdinstall, что они значат и как на них отвечать.
* Как решать проблемы при сбоях установки.
* Как получить доступ к Live-версии FreeBSD до того, как принять решение о её установке.

Перед прочтением этого раздела вам необходимо:

* Прочитать список совместимого оборудования, который поставляется с устанавливаемой версией FreeBSD, и убедиться в том, что имеющееся в системе оборудование является таковым.

[[bsdinstall-hardware]]
== Минимальные аппаратные требования

Требования к оборудованию, необходимому для установки FreeBSD, отличаются между собой и зависят от архитектуры.
Аппаратные архитектуры и устройства, поддерживаемые каким-либо релизом FreeBSD, перечислены на странице link:https://www.FreeBSD.org/releases/index.html[Информации о релизах FreeBSD].

link:https://www.FreeBSD.org/where.html[Страница сгрузки FreeBSD] также содержит рекомендации по корректному выбору образа для разных архитектур.

Для установки FreeBSD потребуется как минимум 96 МБ ОЗУ и 1,5 ГБ свободного дискового пространства.
Однако столь малые объёмы оперативной памяти и дискового пространства на самом деле подходят только для специализированных применений типа встраиваемых устройств.
Настольным системам общего назначения требуется больше ресурсов.
2-4 ГБ ОЗУ и по крайней мере 8 ГБ дискового пространства являются хорошей стартовой точкой.

Вот требования к процессору для каждой архитектуры:

AMD64::
Это самый массовый тип процессоров для настольных компьютеров и ноутбуков, используемый в большинстве современных систем.
Intel(R) называет его Intel64.
Другие производители иногда называет его x86-64.

Примерами процессоров, совместимых с amd64, являются AMD Athlon, AMD Opteron, многоядерные Intel(R) Xeon(TM), Intel(R) Core(TM) 2 и более поздние.

i386::
Эта 32-разрядная архитектура x86 часто используются в более старых настольных компьютерах и ноутбуках.

Поддерживаются практически все совместимые с i386 процессоры с математическим сопроцессором.
Поддерживаются все процессоры Intel(R) с системой команд 486 и выше.

FreeBSD будет использовать преимущества технологии PAE (Physical Address Extensions) при работе на ЦПУ с этой функцией.
Ядро с включённой функцией PAE будет распознавать память выше 4 ГБ и обеспечит её использование системой.
Однако использование PAE накладывает ограничения на драйверы устройств и другие возможности FreeBSD.

powerpc::
Поддерживаются все системы Apple(R) Mac(R) типа New World со встроенным USB.
Для многопроцессорных машин есть поддержка SMP.

32-разрядное ядро может использовать лишь первые 2 ГБ ОЗУ.

sparc64::
Системы, поддерживаемые FreeBSD/sparc64, перечислены в link:https://www.FreeBSD.org/platforms/sparc/[Проекте FreeBSD/sparc64].

SMP поддерживается во всех системах с более чем 1 процессором.
Требуется отдельный жёсткий диск, так как на данный момент нет возможности использовать диск совместно с другой операционной системой.

[[bsdinstall-pre]]

После того, как было определено, что система соответствует минимальным требованиям к аппаратному обеспечению для установки FreeBSD, необходимо сгрузить установочный файл и подготовить установочный носитель.
До того, как это делать, проверьте готовность системы к установке по пунктам следующего контрольного списка:

.[procedure]
====
. *Выполните резервное копирование важных данных*
+
Перед тем, как устанавливать любую операционную систему, прежде всего _всегда_ выполняйте резервное копирование всех важных данных.
Не храните резервную копию в той же системе, где производится установка.
Напротив, храните данные на сменном диске, вроде USB, в другой системе в сети или в онлайновом сервисе хранения резервных копий.
Проверьте резервную копию до начала установки, чтобы быть уверенным, что в ней содержатся все нужные файлы.
В момент, когда программа установки форматирует диск системы, все данные на этом диске теряются.
. *Определитесь с местом установки FreeBSD*
+
Если FreeBSD будет единственной установленной операционной системой, то этот шаг может быть пропущен.
Однако если FreeBSD будет использовать диск совместно с другими операционными системами, то решите, какой диск или его раздел будет использоваться для FreeBSD.
+
В архитектурах i386 и amd64 диски могут быть разделены на несколько разделов с применением одного из методов разбиения.
Традиционный метод использует MBR (Master Boot Record), в которой хранится таблица разделов, вмещающая до четырёх _первичных_ разделов.
Исторически сложилось так, что во FreeBSD эти разделы называются _слайсами_.
Один из первичных разделов может быть обозначен _расширенным разделом_, содержащим несколько _логических разделов_.
_Таблица разделов GUID_ (GUID Partition Table) является более новым и простым способом деления диска.
Распространённые реализации GPT позволяют создавать до 128 разделов на одном диске, исключая необходимость в логических разделах.
+
Загрузчику FreeBSD необходим либо первичный раздел, либо раздел GPT.
Если все первичные разделы или разделы GPT уже используются, то один из них нужно будет освободить для FreeBSD.
Для создания раздела без удаления существующих данных воспользуйтесь утилитой изменения размеров разделов для того, чтобы уменьшить размер существующего раздела и создать новый раздел, использующий высвободившееся пространство.
+
Различные свободно распространяемые и коммерческие инструменты для изменения размеров разделов перечислены на странице link:http://en.wikipedia.org/wiki/List_of_disk_partitioning_software[http://en.wikipedia.org/wiki/List_of_disk_partitioning_software].
GParted Live (link:http://gparted.sourceforge.net/livecd.php[http://gparted.sourceforge.net/livecd.php] является свободно распространяемым загружаемым CD, в который включён редактор разделов GParted.
GParted включён также во многие другие дистрибутивы Linux формата загружаемого CD.
+
[WARNING]
====
При правильном их использовании утилиты уменьшения размера диска могут безопасно формировать пространство для создания новых разделлов
Так существует вероятность ошибки при выборе раздела, всегда создавайте резервные копии любых важных данных и проверяйте целостность этих копий до того, как модифицировать дисковые разделы.
====
+
Наличие дисковых разделов, содержащих разные операционные системы, делает возможной установку разных операционных систем на один компьютер.
Альтернативой является использование виртуализации (<<virtualization>>), позволяющей запускать одновременно несколько операционных систем без изменения каких бы то ни было дисковых разделов.
. *Соберите информацию о конфигурации сети*
+
Некоторым вариантам установки FreeBSD для того, чтобы загрузить установочные файлы, требуется наличие соединения с сетью.
После завершения любой установки программа установки предложит настроить сетевые интерфейсы системы.
+
Если в сети присутствует сервер DHCP, то он может быть использован для обеспечения автоматической настройки сетевых параметров.
Если в подключаемой сети сервис DHCP отсутствует, то для настройки сетевых параметров системы у местного сетевого администратора или провайдера Интернет должна быть получена следующая информация:
+
.Необходимые данные о сети
. IP-адрес
. Маска подсети
. IP-адрес шлюза, используемого по умолчанию
. Доменное имя сети
. IP-адреса DNS-серверов сети
+
. *Проверьте сведения об обнаруженных ошибках FreeBSD*
+
Хотя проект FreeBSD борется за то, чтобы каждый релиз FreeBSD был стабильным настолько, насколько это возможно, ошибки порой вкрадываются в процесс разработки.
В очень редких случаях эти ошибки влияют на процесс установки.
По мере обнаружения и исправления этих проблем они описываются в Списке найденных ошибок FreeBSD (link:https://www.FreeBSD.org/releases/{rel121-current}R/errata/[https://www.FreeBSD.org/releases/{rel121-current}R/errata/]), размещаемом на веб-сайте FreeBSD.
Проверьте этот список перед установкой и убедитесь, что отсутствуют проблемы, которые могут затронуть установку.
+
Информация о релизах и списки найденных ошибок для всех релизов можно найти в разделе веб-сайта FreeBSD, содержащем информацию о релизах (link:https://www.FreeBSD.org/releases/[https://www.FreeBSD.org/releases/]).
====

[[bsdinstall-installation-media]]
=== Подготовка установочного носителя

Программа установки FreeBSD не является приложением, которое можно запустить из другой операционной системы.
Напротив, сгрузите файл установки FreeBSD, запишите его на носитель, соответствующий типу и размеру этого файла (CD, DVD или USB) и выполните загрузку системы для установки со вставленного носителя.

Установочные файлы FreeBSD доступны по ссылке link:https://www.FreeBSD.org/where.html#download[https://www.FreeBSD.org/where.html#download]. 
Наименование каждого установочного файла включает версию релиза FreeBSD, архитектуру и тип файла.
К примеру, для установки FreeBSD 12.1 на систему amd64 c DVD сгрузите файл FreeBSD-12.1-RELEASE-amd64-dvd1.iso, пропишите этот образ на DVD и загрузите систему со вставленным DVD.

Установочные файлы доступны в нескольких форматах.
Форматы отличаются между собой и зависят от компьютерной архитектуры и типа носителя.

[[bsdinstall-installation-media-uefi]]
Для компьютеров, загрузка которых осуществляется через UEFI (Unified Extensible Firmware Interface), доступны дополнительные установочные файлы.
В названиях этих файлов присутствует строка [.filename]#uefi#.

Типы файлов:

* `-bootonly.iso`: Это самый маленький установочный файл, потому что он содержит только программу установки. Во время установки требуется наличие работающего соединения с Интернет, так как программа установки будет сгружать файлы по мере необходимости для завершения установки FreeBSD. Этот файл должен быть прописан на CD при помощи программы записи CD.
* `-disc1.iso`: Этот файл содержит все файлы, требуемые для установки FreeBSD, её исходный код и Коллекцию портов. Он должен быть прописан на CD при помощи программы записи CD.
* `-dvd1.iso`: Этот файл содержит все файлы, требуемые для установки FreeBSD, её исходный код и Коллекцию портов. Также он содержит набор популярных откомпилированных пакетов для установки оконных менеджеров и некоторых приложений, так что полноценная система может быть установлена с носителя без необходимости в подключении к Интернет. Этот файл должен быть прописан на DVD при помощи программы записи DVD.
* `-memstick.img`: Этот файл содержит все файлы, требуемые для установки FreeBSD, её исходный код и Коллекцию портов. Он должен быть прописан на USB-носитель в соответствии с указаниями ниже.
* `-mini-memstick.img`: Подобно `-bootonly.iso`, не содержит установочные файлы, но скачивает их по необходимости. Во время установки требуется работающее соединение с Интернет. Запишите этот файл на USB-носитель, как это описано в <<bsdinstall-usb>>.

После сгрузки файла с образом скачайте файл [.filename]#CHECKSUM.SHA256# из того же каталога.
Выполните подсчёт _контрольной суммы_ для файла с образом.
Для этого во FreeBSD имеется &man.sha256.1;, которая применяется в виде `sha256 imagefilename`.
В других операционных системах имеются похожие программы.

Сравните полученную контрольную сумму с той, что содержится в [.filename]#CHECKSUM.SHA256#.
Контрольные суммы должны быть полностью идентичными.
Несовпадение контрольных сумм означает, что файл образа повреждён и должен быть сгружен повторно.

[[bsdinstall-usb]]
==== Запись файла образа на USB

Файл [.filename]#*.img# является _образом_ всего содержимого флеш-накопителя.
Его _нельзя_ просто скопировать на целевое устройство как файл.
Для записи [.filename]#*.img# на флеш-накопитель USB имеется несколько приложений.
Этот раздел описывает две такие утилиты.

[IMPORTANT]
====
Перед тем, как продолжить, выполните резервное копирование всех важных данных, находящихся на флеш-накопителе USB.
Данная процедура удалит данные, имеющиеся на накопителе.
====

[[bsdinstall-usb-dd]]
[.procedure]
====
*Procedure. Использование команды `dd` для записи образа* +

[WARNING]
====
В этом примере в качестве устройства, на которое производится запись, используется [.filename]#/dev/da0#.
Будьте _очень внимательны_ к корректности указания устройства, так как эта команда уничтожит данные, находящиеся на указываемом целевом устройстве.
====

. Утилита командной строки man:dd[1] имеется в системах BSD, Linux и Mac OS(R).
Для записи образа при помощи `dd` вставьте флеш-накопитель USB и определите имя соответствующего устройства.
Затем задайте имя сгруженного установочного файла и имя устройства флеш-накопителя.
В этом примере установочный образ amd64 записывается на первое устройство USB в существующей системе FreeBSD.
+
[source,shell]
....
# dd if=FreeBSD-12.1-RELEASE-amd64-memstick.img of=/dev/da0 bs=1M conv=sync
....
+
Если запуск этой команды завершился неудачно, удостоверьтесь, что флеш-накопитель USB не смонтирован и имя устройства соответствует диску, а не дисковому разделу.
В некоторых операционных системах может потребоваться запускать эту команду при помощи man:sudo[8].
Синтаксис команды man:dd[1] на разных платформах несколько отличается; к примеру, Mac OS(R) требует указания параметра `bs=1m` в нижнем регистре.
Системы, подобные Linux(R), могут буферизировать операции записи.
Для принудительного завершения всех операций записи воспользуйтесь командой man:sync[8].
======

[.procedure]
======
*Procedure: Использование Windows(R) для записи образа*

[WARNING]
****
Удостоверьтесь в правильности выбора буквы диска, так как имеющиеся данные будут перезаписаны и уничтожены.
****
.. Получение Image Writer для Windows(R)
+ 
Image Writer для Windows(R) - это свободно распространяемое приложение, при помощи которого можно корректно записать файл образа на флеш-накопитель.
Скачайте его с https://https://sourceforge.net/projects/win32diskimager/[https://sourceforge.net/projects/win32diskimager/] и распакуйте в любой каталог.
.. Запись образа при помощи Image Writer
+ 
Кликните дважды на иконке Win32DiskImager для запуска приложения. Удостоверьтесь, что буква диска, отображаемая в боксе `Device`, соответствует устройству флеш-накопителя. Кликните на иконке с папкой и выберите образ, который будет записан на флеш-накопитель. Нажмите кнопку btn:[Save] для подтверждения выбора имени файла. Проверьте, что всё верно, а также что нет открытых директорий с флеш-накопителя в других окнах. Когда всё готово, нажмите кнопку btn:[Write] для записи образа на флеш-накопитель.

Теперь вы готовы начать установку FreeBSD.
====

[[bsdinstall-start]]
== Начало установки

[IMPORTANT]
====
По умолчанию, программа установки не вносит никаких изменений в данные на дисках до следующего сообщения:

[.programlisting]
....
Your changes will now be written to disk. If you
have chosen to overwrite existing data, it will
be PERMANENTLY ERASED. Are you sure you want to
commit your changes?
....

Из программы установки можно выйти в любой момент до появления этого предупреждения.
Если ощущается неуверенность в правильности настроек, просто выключите компьютер до этого сообщения, и тогда не будет сделано никаких изменений на дисках системы.
====

Этот раздел описывает, как выполнить загрузку системы с установочного носителя, который был ранее подготовлен по инструкциям в <<bsdinstall-installation-media>>.
При использовании загрузочной флешки USB подключите её в разъём USB до включения компьютера.
При загрузке с CD или DVD включите компьютер и вставьте носитель при первой возможности.
Порядок настройки системы на загрузку с вставленного носителя зависит от архитектуры.

[[bsdinstall-starting-i386]]
=== Загрузка i386(TM) и amd64

Эти архитектуры предоставляют меню BIOS для выбора загрузочного устройства.
В зависимости от используемого установочного носителя выберите устройство CD/DVD или USB в качестве первого загрузочного.
Большинство систем также имеют кнопку выбора устройства для загрузки во время запуска без необходимости входа в BIOS.
Обычно в качестве такой кнопки выступает kbd:[F10], kbd:[F11], kbd:[F12] или kbd:[Escape].

Если компьютер загружает существующую операционную систему вместо программы установки FreeBSD, то это может значить одно из следующего: 

. В процессе загрузки установочный носитель был вставлен слишком поздно. Оставьте его вставленным и попробуйте перезапустить компьютер.
. Изменения, внесённые в параметры BIOS, были неверными или не были сохранены. Проверьте ещё раз, что первое загрузочное устройство выбрано правильно.
. Данная система слишком стара для того, чтобы поддерживать загрузку с выбранного носителя. В таком случае для загрузки системы с желаемого носителя можно использовать Plop Boot Manager (link:http://www.plop.at/en/bootmanagers.html[http://www.plop.at/en/bootmanagers.html]).

=== Загрузка PowerPC(R)

На большинстве машин нажатие и удерживание клавиши kbd:[C] на клавиатуре во время начальной загрузки активирует загрузку с CD.
Если это не так, то нажмите и удерживайте kbd:[Command+Option+O+F] или kbd:[Windows+Alt+O+F] на не-Apple(R) клавиатурах. На приглашение `0 >` введите

[source,shell]
....
 boot cd:,\ppc\loader cd:0
....

=== Загрузка SPARC64(R)

Большинство систем SPARC64(R) настроены на автоматическую загрузку с жёсткого диска.
Для установки FreeBSD с CD необходим вход в PROM.

Для этого перегрузите систему и дождитесь появления загрузочных сообщений. Текст сообщений зависит от модели машины, но должен выглядеть подобно следующему:

[source,shell]
....
Sun Blade 100 (UltraSPARC-IIe), Keyboard Present
Copyright 1998-2001 Sun Microsystems, Inc.  All rights reserved.
OpenBoot 4.2, 128 MB memory installed, Serial 51090132.
Ethernet address 0:3:ba:b:92:d4, Host ID: 830b92d4.
....

Если в этот момент компьютер продолжает загружаться с жёсткого диска, то для получения приглашения PROM вам необходимо нажать на клавиатуре kbd:[L1+A] или kbd:[Stop+A], или же послать сигнал `BREAK` через консоль, подключённую к последовательному порту.
При использовании утилит tip или cu сигнал BREAK генерируется при наборе `~#`.
Приглашение PROM имеет форму `ok` в системах с одним ЦПУ и `ok {0} ` в многопроцессорных (SMP) системах, при этом цифра указывает на номер активного ЦПУ.

На этом этапе вставьте CD в привод и наберите `boot cdrom` в приглашении PROM.

[[bsdinstall-view-probe]]
=== Меню загрузки FreeBSD

Как только система загрузится с установочного носителя, будет отображено меню, подобное следующему:

[[bsdinstall-newboot-loader-menu]]
.Меню загрузчика FreeBSD
image::bsdinstall/bsdinstall-newboot-loader-menu[]

По умолчанию это меню будет ожидать пользовательского ввода в течение десяти секунд до загрузки программы установки FreeBSD или, если FreeBSD уже установлена, запустит FreeBSD.
Чтобы приостановить таймер загрузки для просмотра возможных вариантов, нажмите kbd:[Space].
Для выбора варианта нажмите соответствующий подсвеченный номер, букву или клавишу.
К выбору доступны следующие варианты:

* `Boot Multi User`: Продолжит процесс загрузки FreeBSD. Если таймер загрузки был приостановлен, то нажмите kbd:[1], kbd:[B] (в верхнем или нижнем регистре) или kbd:[Enter].
* `Boot Single User`: Этот режим может использоваться для проведения аварийных работ на существующей инсталляции FreeBSD, как описано в <<boot-singleuser>>. Нажмите kbd:[2] или kbd:[S] (в верхнем или нижнем регистре) для перехода в этот режим.
* `Escape to loader prompt`: Загрузит систему в режим командной строки аварийного режима, который содержит ограниченный набор низкоуровневых команд. Этот режим описан в <<boot-loader>>. Нажмите kbd:[3] или kbd:[Esc] для перехода в этот режим.
* `Reboot`: Выполняет перезагрузку системы.
* `Kernel`: Загружает другое ядро.
* `Configure Boot Options`: Открывает режим меню, показанный и описанный в <<bsdinstall-boot-options-menu>>.

[[bsdinstall-boot-options-menu]]
.Меню параметров загрузки FreeBSD
image::bsdinstall/bsdinstall-boot-options-menu[]

Меню параметров загрузки разделено на две секции.
Первая секция может использоваться либо для возврата к основному меню загрузки, либо для сброса любых выбранных параметров к их первоначальным значениям, используемым по умолчанию.

Следующая секция используется для переключения значений доступных параметров в состояние `On` или `Off` нажатием подсвеченного номера или символа, соответствующих параметру.
При загрузке система всегда будет использовать значения этих параметров, пока они не будут изменены.
При помощи этого меню может быть переключить значения нескольких параметров:

* `ACPI Support`: Если при загрузке система "зависает", попробуйте переключить значение этого параметра в `Off`.
* `Safe Mode`: Если система продолжает "зависать" во время загрузки даже при значении параметра `ACPI Support`, установленного в `Off`, попробуйте установить значение данного параметра в `On`.
* `Single User`: Переключите значение этого параметра в `On` для проведения аварийных работ существующей инсталляции FreeBSD, как это описано в <<boot-singleuser>>. После устранения проблемы верните этот параметр в значение `Off`.
* `Verbose`: Переведите значение этого параметра в `On` для просмотра более детализированных сообщений во время процесса загрузки. Это может быть полезным при устранении проблем с каким-либо оборудованием.

После выбора необходимых параметров нажмите kbd:[1] или kbd:[Backspace] для возврата к основному меню загрузки, а затем нажмите kbd:[Enter] для продолжения загрузки FreeBSD.
По мере того, как FreeBSD будет выполнять обнаружение устройств и загрузку программы установки, будут выдаваться соответствующие сообщения загрузки.
После завершения загрузки будет выдано начальное меню, показанное в <<bsdinstall-choose-mode>>.

[[bsdinstall-choose-mode]]
.Начальное меню
image::bsdinstall-choose-mode.png[]

Нажмите kbd:[Enter] для подтверждения выбранного по умолчанию режима btn:[Install] и перехода в программу установки.
Оставшаяся часть этой главы описывает порядок использования программы установки.
Либо воспользуйтесь клавишами навигации влево и вправо или буквой, выделенной цветом, для выбора нужного пункта меню.
Пункт btn:[Shell] может быть использован для обращения к оболочке командной строки FreeBSD и вызова утилит командной строки с целью подготовки дисков до установки.
Пункт btn:[Live CD] можно использовать для ознакомления с FreeBSD до её установки.
Загружаемая версия описана в <<using-live-cd>>.

[TIP]
====
Для просмотра сообщений, выданных при загрузке, в том числе при распознавании устройств, нажмите kbd:[S] в верхнем или нижнем регистре, а затем kbd:[Enter] для доступа к оболочке командной строки.
В приглашении оболочки наберите `more /var/run/dmesg.boot` и используйте клавишу пробела для пролистывания сообщений.
По завершению наберите `exit` для возврата к начальному меню.
====

[[using-bsdinstall]]
== Использование bsdinstall

В этом разделе описаны последовательность меню bsdinstall и виды информации, которая будет запрашиваться перед установкой системы.
Используйте клавиши навигации для подсветки вариантов выбора, а затем kbd:[Пробел] для выбора или отказа от выбора соответствующего пункта меню.
После завершения выбора нажмите клавишу kbd:[Ввод] для сохранения выбора и перехода на следующий экран.

[[bsdinstall-keymap]]
=== Выбор раскладки клавиатуры

Перед тем, как продолжить работу, bsdinstall загрузит файлы с раскладками клавиатуры, как это показано в <<bsdinstall-keymap-loading>>.

[[bsdinstall-keymap-loading]]
.Загрузка раскладки клавиатуры
image::bsdinstall-keymap-loading.png[Загрузка раскладки клавиатуры]

После загрузки раскладок клавиатуры bsdinstall отображает меню, изображённое на <<bsdinstall-keymap-10>>.
Используйте клавиши навигации вверх и вниз для выбора раскладки, которая в наибольшей степени соответствует раскладке клавиатуры, подключенной к системе.
Нажмите kbd:[Enter] для сохранения выбора. 

[[bsdinstall-keymap-10]]
.Меню выбора раскладки клавиатуры
image::bsdinstall-keymap-10.png[Меню выбора раскладки клавиатуры]

[NOTE]
====
Нажатие kbd:[Esc] приведёт к выходу из этого меню и использованию раскладки, применяемой по умолчанию.
Если выбор раскладки клавиатуры вызывает затруднения, то ещё одним безопасным вариантом является использование [.guimenuitem]#United States of America ISO-8859-1#.
====

Кроме того, при выборе другой раскладки клавиатуры пользователь может попробовать её в действии и удостовериться в том, что она корректна, до продолжения работы, как это показано в <<bsdinstall-keymap-testing>>.

[[bsdinstall-keymap-testing]]
.Меню проверки раскладки клавиатуры
image::bsdinstall-keymap-testing.png[Меню проверки раскладки клавиатуры]

[[bsdinstall-hostname]]
=== Настройка имени машины

Следующее меню <application>bsdinstall</application> используется для указания имени машины для свежеустанавливаемой системы.

[[bsdinstall-config-hostname]]
.Установка имени хоста
image::bsdinstall-config-hostname.png[]

Введите имя машины, уникальное для сети.
Оно должно быть полным, например: `machine3.example.com`.

[[bsdinstall-components]]
=== Выбор устанавливаемых компонентов

Далее, bsdinstall предложит выбрать дополнительные компоненты для установки.

[[bsdinstall-config-components]]
.Выбор устанавливаемых компонентов
image::bsdinstall-config-components.png[]

Определение перечня компонентов для установки в наибольшей мере зависит от планируемого использования системы и от количества доступного дискового пространства.
Ядро и набор пользовательских утилит FreeBSD, вместе называемые _базовой системой_, устанавливаются всегда.
В зависимости от архитектуры, некоторые из следующих компонентов могут не отображаться:

* `base-dbg` - Базовые инструменты, такие как cat или ls, помимо всех прочих, с активированной отладочной информацией.
* `kernel-dbg` - Ядро и модули с активированной отладочной информацией.
* `lib32-dbg` - Библиотеки совместимости для запуска 32-разрядных приложений в 64-разрядной версии FreeBSD с активированной отладочной информацией.
* `lib32` - Библиотеки совместимости для запуска 32-битных приложений на 64-битных версиях FreeBSD.
* `ports` - Коллекция портов FreeBSD представляет собой набор файлов, при помощи которых автоматизируется сгрузка, компиляция и установка программных пакетов сторонних разработчиков. В <<ports>> описывается, как использовать Коллекцию портов.
+
[WARNING]
====
Программа установки не проверяет наличие достаточного свободного пространства.
Выбирайте эту опцию лишь в случае, когда имеется достаточно свободного места на жёстком диске.
Коллекция Портов занимает около {ports-size} дискового пространства.
====

* `src` - Полный исходный код FreeBSD, как ядра, так и пользовательских программ. Хотя для большинства задач исходный код системы не нужен, он может потребоваться для построения драйверов устройств, модулей ядра или некоторых программ из Коллекции портов. Он также используется для разработки самой FreeBSD. Полное дерево исходных кодов требует 1 ГБ дискового пространства, а пересборка всей системы FreeBSD потребует ещё 5 ГБ.
* `tests` - Пакет тестирования FreeBSD.

[[bsdinstall-netinstall]]
=== Установка по сети

Меню, изображённое в <<bsdinstall-netinstall-notify>>, появляется только при установке с CD [.filename]#-bootonly.iso#, так как этот установочный носитель не содержит копий установочных файлов.
Так как получение установочных файлов должно выполняться через сетевое соединение, это меню указывает на то, что сначала должен быть настроен сетевой интерфейс.

[[bsdinstall-netinstall-notify]]
.Установка по сети
image::bsdinstall-netinstall-files.png[]

Для настройки сетевого подключения нажмите kbd:[Ввод] и следуйте инструкциям из <<bsdinstall-config-network-dev>>.
После настройки интерфейса выберите зеркало, размещённое в том регионе мира, что и компьютер, на который устанавливается FreeBSD.
Если зеркало расположено ближе к целевому компьютеру, то файлы могут быть получены быстрее, что сокращает время установки.

[[bsdinstall-netinstall-mirror]]
.Выбор зеркала сайта
image::bsdinstall-netinstall-mirrorselect.png[]

После этого установка продолжится так, как будто бы установочные файлы размещены на локальном установочном носителе.

[[bsdinstall-partitioning]]
== Распределение дискового пространства

Следующее меню используется для задания метода распределения дискового пространства.

[[bsdinstall-zfs-partmenu]]
.Варианты распределения
image::bsdinstall-zfs-partmenu.png[Варианты распределения]

bsdinstall предлагает пользователю четыре способа распределения дискового пространства:

* `Auto (UFS)`. Автоматически настраивает разделы диска с использованием файловой системы `UFS`.
* `Manual`. Позволяет опытным пользователям создавать разделы в соответствии с собственными требованиями, используя варианты из меню.
* `Shell`. Запускает оболочку командного процессора, в котором опытные пользователи могут создавать разделы в соответствии с собственными требованиями, используя утилиты командной строки, подобные &man.gpart.8;, &man.fdisk.8; и &man.bsdlabel.8;.
* `Auto (ZFS)`. Создаёт корневую файловую систему в формате ZFS с опциональной поддержкой  шифрования GELI для _загрузочных сред_.

В этом разделе описываются факторы, которые необходимо учитывать при разбиения диска на разделы.
Затем в нём показывается, как использовать различные методы распределения дискового пространства.

[[configtuning-initial]]
=== Планирование размещения разделов

При размещении файловых систем помните, что жёсткие диски передают данные быстрее от внешних дорожек к внутренним.
Таким образом, файловые системы меньшего размера и высоконагруженные файловые системы должны быть ближе к внешней границе накопителя, тогда как более крупные разделы, подобные [.filename]#/usr#, должны размещаться ближе к центру диска.
Хорошей идеей является создание разделов примерно в следующем порядке: [.filename]#/#, swap, [.filename]#/var# и [.filename]#/usr#.

Размер раздела [.filename]#/var# отражает предполагаемое использование машины.
Этот раздел используется для размещения почтовых ящиков, файлов журналирования событий и очередей печати.
Почтовые ящики и файлы журналов могут расти до непрогнозируемых размеров в зависимости от количества пользователей и того, как долго хранятся файлы журналов.
В среднем большинству пользователей редко требуется более одного гигабайта свободного дискового пространства в [.filename]#/var#.

[NOTE]
====
Иногда возникает потребность в выделении большого объёма дисковом пространстве в [.filename]#/var/tmp#.
Когда устанавливается новое программное обеспечение, инструменты работы с пакетами разворачивают их временную копию в каталоге [.filename]#/var/tmp#.
При установке больших пакетов програмного обеспечения, подобных Firefox или LibreOffice, могут возникнуть сложности, если в каталоге [.filename]#/var/tmp# будет недостаточно дискового пространства.

Раздел [.filename]#/usr# содержит многие из файлов, обеспечивающих поддержку системы, включая Коллекцию портов FreeBSD и исходный код системы.
Рекомендуемое пространство для этого раздела составляет по меньшей мере 2 гигабайта.

При определении размеров разделов помните о требованиях к дисковому пространству.
Исчерпание пространства одного раздела и слабое его использование в другом может стать неприятным фактом.

Общее правило заключается в том, что размер раздела подкачки должен быть примерно в два раза больше объёма оперативной памяти (ОЗУ).
Системы с минимальным объёмам ОЗУ могут работать лучше при увеличении размера памяти подкачки.
Настройка слишком малого объёма памяти подкачки может приводить к неэффективной работе кода сканирования страниц VM и может создать проблемы позже при добавлении дополнительной памяти.

В более крупных системах с несколькими дисками SCSI или IDE, подключёнными к разным контроллерам, рекомендуется создавать разделы подкачки на каждом диске, вплоть до четырёх дисков.
Размер разделов подкачки должен быть примерно одинаковым.
Ядро может обрабатывать любые размеры, однако внутренние структуры данных рассчитываются, исходя из 4-кратного размера самого большого раздела подкачки.
Сохранение разделов подкачки примерно одинаковыми по размеру позволит оптимально распределять пространство подкачки между дисками.
Большой объём памяти подкачки не является какой-то проблемой, даже если она интенсивно не используется.
Также это может облегчить восстановление нормальной работы в результате потери управления над каким-либо приложением до того, как возникнет необходимость в перезапуске системы.

При корректном планировании разделов системы фрагментация, появляющаяся в разделх меньшего размера с большим объёмом операций записи, не будет влиять на разделы, где преимущественно осуществляются операции чтения.
Размещение разделов с большим объёмом операций записи ближе к краю диска увеличит производительность операций ввода-вывода для разделов, где они случаются чаще всего.
Хотя производительность ввода-вывода в более крупных разделах может быть востребована, перемещение их ближе к краю диска не приведёт к существенному росту производительности по сравнению с перемещением туда раздела [.filename]#/var.

[[bsdinstall-part-guided]]
=== Шаблонное распредение с использованием UFS

При выборе этого метода в меню будут отображены доступные диски (или один диск).
Если в системе подключено несколько дисков, то выберите один, на который будет устанавливаться FreeBSD.

[[bsdinstall-part-guided-disk]]
.Выбор из множества дисков
image::bsdinstall-part-guided-disk.png[]

После выбора диска следующее меню запрашивает выбор установки с использованием всего диска либо с созданием раздела в свободном пространстве.
Если выбирается вариант btn:[Entire Disk], то автоматически выполняется стандартное распределение, занимающее весь диск. Выбор btn:[Partition] приводит к созданию разделов из неиспользуемого дискового пространства.

[[bsdinstall-part-entire-part]]
.Выбор всего диска или раздела
image::bsdinstall-part-entire-part.png[]

После выбора btn:[Entire Disk] программа установки bsdinstall отображает диалоговое окно, указывающее на то, что диск будет очищен.

[[bsdinstall-ufs-warning]]
.Подтверждение
image::bsdinstall-ufs-warning.png[Подтверждение]

Последующее меню содержит список типов схем разделов.
Как правило, GPT является самым подходящим вариантом для компьютеров amd64.
Более старые компьютеры, не являющиеся совместимыми с GPT, должны использовать  MBR.
Прочие схемы разделов обычно используются с редко встречающимися или более старыми компьютерами.
Дополнительная информацию можно найти в <<partition-schemes>>.

[[bsdinstall-ufs-scheme]]
.Выбор схемы раздела
image::bsdinstall-part-manual-partscheme.png[Выбор схемы раздела]

После завершения планирования дискового пространства внимательно проанализируйте результат на предмет соответствия задачам данной инсталляции.
Выбор btn:[Revert] сбросит состояние разделов к их исходному состоянию, а выбор btn:[Auto] приведёт к их автоматическому пересозданию.
Также разделы могут быть созданы, изменены или удалены вручную.
Если результат разбиения корректен, выберите btn:[Finish] для продолжения установки.

[[bsdinstall-part-review]]
.Просмотр созданных разделов
image::bsdinstall-part-review.png[]

После завершения конфигурации дискового пространства следующее меню предоставляет последний шанс для внесения изменений до того, как выбранные диски будут отформатированы.
Если требуется внести изменения, выберите btn:[Back] для возврата к основному меню распределения дискового пространства.
btn:[Revert & Exit] приведёт к выходу из программы установки без внесения каких-либо изменений на диск.
Выберите btn:[Commit] для запуска процесса установки.

[[bsdinstall-ufs-final-confirmation]]
.Окончательное подтверждение
image::bsdinstall-final-confirmation.png[Окончательное подтверждение]

Для продолжения процедуры установки перейдите к <<bsdinstall-fetching-distribution>>.

[[bsdinstall-part-manual]]
=== Ручное (manual) разбиение

При выборе этого метода запускается редактор разделов.

[[bsdinstall-part-manual-create]]
.Ручное создание разделов
image::bsdinstall-part-manual-create.png[]

Пометьте диск для установки (в этом примере [.filename]#ada0#) и выберите btn:[Create] для отображения меню с перечнем доступных схем разбиения на разделы:

[[bsdinstall-part-manual-partscheme]]
.Выбор схемы разбиения
image::bsdinstall-part-manual-partscheme.png[]

Как правило, схема GPT является наиболее подходящей для компьютеров amd64.
Для более старых компьютеров, несовместимых с GPT, нужно использовать MBR.
Остальные схемы разбиения разделов в общем используются для редких или старых вычислительных систем.

[[partition-schemes]]
.Схемы разбиения
[cols="25h,~", frame="none", options="header"]
|===
<| Аббревиатура
<| Описание

|APM
|Карта разделов Apple, используемая в PowerPC(R).

|BSD
|Схема разделов BSD без MBR, иногда называемая _опасный эксклюзивный режим_, так как дисковые утилиты не из мира BSD могут его не распознать.

|GPT
|Таблица разделов GUID (link:http://en.wikipedia.org/wiki/GUID_Partition_Table[http://en.wikipedia.org/wiki/GUID_Partition_Table].

|MBR
|Master Boot Record (link:http://en.wikipedia.org/wiki/Master_boot_record[http://en.wikipedia.org/wiki/Master_boot_record].

|VTOC8
|Volume Table Of Contents, используемая в компьютерах Sun SPARC64 и UltraSPARC.
|===

После того, как схема разбиения определена и создана, выберите btn:[Create] повторно для создания дисковых разделов.
Для перемещения курсора между полями используется клавиша kbd:[Tab]. 

[[bsdinstall-part-manual-addpart]]
.Создание новых разделов в неавтоматизированном режиме
image::bsdinstall-part-manual-addpart.png[]

Стандартная установка FreeBSD со схемой GPT создаст как минимум три раздела:

* `freebsd-boot` - Содержит загрузочный код FreeBSD.
* `freebsd-ufs` - Файловая система FreeBSD формата UFS.
* `freebsd-swap` - FreeBSD область подкачки.

Ещё одним типом раздела, который следует упомянуть, является `freebsd-zfs`, используемый для разделов, которые будут содержать файловую систему FreeBSD ZFS (<<zfs>>).
Обратитесь к man:gpart[8] для получения описаний доступных типов разделов GPT.

Возможно создание большего количества разделов с файловыми системами, и некоторые пользователи предпочитают выделять отдельные разделы для таких файловых систем, как [.filename]#/#, [.filename]#/var#, [.filename]#/tmp# и [.filename]#/usr#.
Пример можно найти в <<bsdinstall-part-manual-splitfs>>.

В качестве параметра `Size` при указании размеров допускается использование общепринятых аббревиатур, таких как _K_ для килобайт, _M_ для мегабайт, или _G_ для гигабайт.

[TIP]
====
Должное выравнивание секторов обеспечивает наилучшую производительность, а создание разделов с размерами, кратными 4 Кбайт, помогает обеспечить правильное выравнивание как на дисках с размером сектора 512 байт, так и на устройствах с размером сектора 4 Кбайт.
Вообще говоря, задание размеров, кратных 1 Мбайт или 1 Гбайт - это наиболее простой способ выполнить выравнивание начал разделов на позицию, кратную 4 Кбайт.
Имеется одно исключение: размер раздела _freebsd-boot_ не должен превышать 512 Кбайт из-за текущих ограничений загрузочного кода.
====

В случае, если раздел будет содержать файловую систему, ей потребуется `точка монтирования`.
Если будет создаваться только один раздел UFS, то точкой монтирования должен быть [.filename]#/#.

`Метка` является именем, под которым будет распознаваться раздел.
Имя устройства или его номер может измениться если устройство будет подключено к другому контроллеру или порту, а метка раздела останется неизменной. Ссылки на метки вместо имён устройств и номеров разделов в файлах типа [.filename]#/etc/fstab# делают систему менее чувствительной к замене оборудования.
Метки GPT появляются после подключения диска в каталоге [.filename]#/dev/gpt/#. У других схем разбиения есть свои особенности поддержки меток, и их метки располагаются в других подкаталогах каталога [.filename]#/dev/#.

[TIP]
====
Во избежание конфликта идентичных меток используйте уникальные названия меток для каждого раздела.
К метке можно добавить несколько букв, взятых от имени компьютера, его назначения или местоположения.
Например, используйте `labroot` или `rootfslab` для корневого раздела UFS компьютера с наименованием `lab`.
====

[[bsdinstall-part-manual-splitfs]]
.Создание разделов для традиционного разбиения на отдельные файловые системы.
[example]
====
Для традиционного разбиения, в котором каталоги [.filename]#/#, [.filename]#/var#, [.filename]#/tmp# и [.filename]#/usr# представляют собой отдельные файловые системы на их собственных разделах, создайте схему разбиения GPT, потом создайте разделы, как это указано ниже. Показанные размеры разделов являются типичными для жесткого диска размером 20Гб. Если диск большего размера, то будет уместным отвести больше места для раздела подкачки или для раздела с файловой системой [.filename]#/var#. Задействованные в этом примере метки имеют префикс `ex`, от слова "example", вам же рекомендуется использовать другие уникальные имена меток.

По умолчанию, загрузчик [.filename]#gptboot# FreeBSD ожидает, что первый найденный раздел UFS будет корневым разделом ([.filename]#/#).

[.informaltable]
[cols="1,1,1,1", frame="none", options="header"]
|===
| Тип раздела
| Размер
| Точка монтирования
| Метка

|`freebsd-boot`
|`512K`

|`freebsd-ufs`
|`2G`
|[.filename]#/#
|`exrootfs`

|`freebsd-swap`
|`4G`
|
|`exswap`

|`freebsd-ufs`
|`2G`
|[.filename]#/var#
|`exvarfs`

|`freebsd-ufs`
|`1G`
|[.filename]#/tmp#
|`extmpfs`

|`freebsd-ufs`
|соглашайтесь со значением по умолчанию (оставшаяся часть объема диска)
|[.filename]#/usr#
|`exusrfs`
|===
====

Для продолжения установки по завершении создания необходимых разделов выберите btn:[Finish].

[[bsdinstall-part-zfs]]
=== Автоматическое формирование разделов с корневой файловой системой ZFS

Поддержка автоматического создания систем с корневой файловой системой ZFS была добавлена во FreeBSD 10.0-RELEASE.
Этот режим работает только с полным объёмом диска и удалит содержимое всего диска.
Программа установки автоматически создаст разделы, границы которых кратны 4Кб, а также явным образом укажет ZFS на использование секторов размером 4Кб.
Это безопасно даже при использовании дисков с размером сектора в 512 байт, а также даёт определённый плюс, гарантируя то, что пулы, созданные на дисках с размером сектора в 512 байт, в будущем смогут работать с дисками с размером сектора в 4Кб, добавляемыми как для расширения пространства хранения, так и в качестве замены вышедших из строя дисков.
Программа установки опционально также может использовать шифрование диска GELI, как это описано в разделе <<disks-encrypting-geli>>.
Если включено шифрование, то создаётся незашифрованный загрузочный пул размером в 2 ГБ, содержащий каталог [.filename]#/boot#.
В нём хранятся ядро и другие файлы, необходимые для загрузки системы.
Также создаётся раздел подкачки размером, определяемым пользователем, а всё оставшееся пространство используется для пула ZFS.

Основное меню настройки ZFS предлагает выбор из нескольких параметров, влияющих на создание пула.

[[bsdinstall-zfs-menu]]
.Меню формирования разделов ZFS
image::bsdinstall/bsdinstall-zfs-menu[]

Выберите kbd:[T] для настройки `Типа пула` и дисков, из которых будет сформирован дисковый пул.
Программа автоматической установки ZFS на данный момент поддерживает создание только единственного vdev самого верхнего уровня, за исключением режима попеременной записи.
Для создания более сложных дисковых пулов воспользуйтесь указаниями в разделе <<bsdinstall-part-shell>> по созданию дискового пула.
Программа установки поддерживает создание различных типов дисковых пулов, включая пулы с чередующейся записью (не рекомендуется, отсутствует избыточность), зеркала (наилучшая производительность, наихудшее использование пространства) и RAID-Z 1, 2 и 3 (с возможностью выдерживать одновременный сбой 1, 2 или 3 дисков, соответственно).
При выборе типа дискового пула внизу экрана отображается подсказка, содержащая информацию о требуемом количестве дисков, а в случае RAID-Z оптимальное количество дисков для каждой конфигурации.

[[bsdinstall-zfs-vdev_type]]
.Тип пула ZFS
image::bsdinstall/bsdinstall-zfs-vdev_type[]

Сразу после выбора `Типа пула` отображается список доступных дисков, а у пользователя запрашивается выбор одного или большего количества дисков для формирования этого пула.
Затем конфигурация проверяется на предмет выбора достаточного количества дисков.
Если это не так, то выберите btn:[Change Selection] для возврата к списку дисков или btn:[Cancel] для изменения типа дискового пула.

[[bsdinstall-zfs-disk_select]]
.Выбор диска
image::bsdinstall/bsdinstall-zfs-disk_select[]

[[bsdinstall-zfs-vdev_invalid]]
.Некорректный выбор
image::bsdinstall/bsdinstall-zfs-vdev_invalid[]

В случае, если один или несколько дисков отсутствуют в списке, либо диски были подключены после запуска программы установки, выберите btn:[- Rescan Devices] для обновления списка доступных дисков.
Для того, чтобы избежать случайного удаления данных на неверно выбранном диске, можно воспользоваться меню btn:[- Disk Info] для проверки данных каждого диска, в том числе таблицы разделов и различной дополнительной информации, такой как номер модели устройства и его серийный номер, если он доступен.

[[bsdinstall-zfs-disk_info]]
.Анализ диска
image::bsdinstall/bsdinstall-zfs-disk_info[]

Главное меню настройки ZFS также позволяет пользователю ввести название дискового пула, отключить принудительное использование секторов 4k, включить или отключить шифрование, переключаться между типами таблиц разделов GPT (рекомендуется) или MBR, а также выбрать размер раздела подкачки.
После того, как значения всех параметров будут установлены в желаемые значения, выберите пункт btn:[>>> Install] в верхней части меню.

Если было включено шифрование диска GELI, то программа установки дважды запросит парольную фразу, которая будет использоваться для шифрования дисков.

[[bsdinstall-zfs-geli_password]]
.Пароль для шифрования дисков
image::bsdinstall/bsdinstall-zfs-geli_password[]

Затем программа установки даст последнюю возможность отмены изменений до того, как содержимое выбранных дисковых накопителей будет уничтожено для создания дискового пула ZFS.

[[bsdinstall-zfs-warning]]
.Последняя возможность
image::bsdinstall/bsdinstall-zfs-warning[]

После этого установка продолжится в обычном режиме.

[[bsdinstall-part-shell]]
=== Формирование разделов в режиме командной строки

При создании сложных конфигураций может оказаться, что различные меню для разбиения дисков программы установки bsdinstall не обеспечивают требуемого уровня гибкости.
Опытные пользователи могу выбрать вариант btn:[Shell] в меню формирования дисковых разделов для того, чтобы разбить диски в неавтоматизированном режиме, создать файловые системы, заполнить файл man:fstab[5] в [.filename]#/tmp/bsdinstall_etc/fstab# и смонтировать файловые системы в [.filename]#/mnt#.
После того, как эти действия будут завершены, наберите команду `exit` для возврата в программу установки bsdinstall и продолжения установки.

[[bsdinstall-fetching-distribution]]
== Сгрузка дистрибутивных файлов

Продолжительность установки варьируется в зависимости от выбранного дистрибутива, способа установки и быстродействия компьютера.
Ход установки будет сопровождаться серией сообщений.

Сначала программа установки форматирует выбранный диск или диски и инициализирует разделы.
Затем, в случае использования носителя `bootonly` или `mini memstick`, она сгружает выбранные компоненты:

[[bsdinstall-distfile-fetching]]
.Сгрузка файлов дистрибутива
image::bsdinstall-distfile-fetching.png[]

Далее выполняется проверка целостности файлов дистрибутива, чтобы удостовериться, что они не были повреждены во время сгрузки или чтения с установочного носителя:

[[bsdinstall-distfile-verify]]
.Проверка файлов дистрибутива
image::bsdinstall-distfile-verifying.png[]

И наконец, верифицированные дистрибутивные файлы распаковываются на диск:

[[bsdinstall-distfile-extract]]
.Извлечение файлов дистрибутива
image::bsdinstall-distfile-extracting.png[]

Как только запрошенные файлы дистрибутива будут развёрнуты, программа установки отобразит первый постустановочный экран настройки.
Доступные постконфигурационные параметры описаны в следующем разделе.

[[bsdinstall-post]]
== После установки

После установки FreeBSD и до загрузки новой установленной системы программа установки выдаст запрос на настройку нескольких параметров.
Этот раздел описывает эти конфигурационные параметры.

[TIP]
====
После загрузки системы команда `bsdconfig` даёт возможность настройки этих и дополнительных параметров системы в виде меню.
====

[[bsdinstall-post-root]]
=== Установка пароля пользователя `root`

В первую очередь обязательно должен быть установлен пароль пользователя `root`.
Во время ввода пароля набираемые символы не отображаются на экране. После ввода будет запрошен повторный ввод пароля. Это помогает предотвратить опечатки при наборе.

[[bsdinstall-post-set-root-passwd]]
.Установка пароля пользователя `root`
image::bsdinstall-post-root-passwd.png[]

[[bsdinstall-config-network-dev]]
=== Настройка сетевых интерфейсов

Затем отображается список сетевых интерфейсов, обнаруженных на компьютере.
Выберите интерфейс для настройки.

[NOTE]
====
Меню настройки сети будут пропущены в случае, если сеть уже была настроена как часть подготовки при установке типа _bootonly_.
====

[[bsdinstall-configure-net-interface]]
.Выберите сетевой интерфейс
image::bsdinstall-configure-network-interface.png[]

Если был выбран интерфейс Ethernet, то программа установки перейдёт к меню, показанному на <<bsdinstall-configure-net-ipv4>>.
Если был выбран беспроводной сетевой интерфейс, то вместо этого системе будет осуществлять поиск беспроводных точек доступа:

[[bsdinstall-wireless-scan]]
.Поиск беспроводных точек доступа
image::bsdinstall-configure-wireless-scan.png[]

Беспроводные сети идентифицируются по так называемому SSID (Service Set Identifier), являющемуся кратким уникальным именем, которое присваивается каждой сети.
Список найденных сетей будет содержать несколько SSID с описанием типов шифрования, поддерживаемых обнаруженными беспроводными сетями.
Если искомый SSID не появляется в списке, то запустите сканирование повторно, выбрав btn:[Rescan]. Если искомая сеть снова не появится в списке, проверьте соединение с антенной или попробуйте разместить компьютер ближе к точке доступа. Запускайте повторный поиск после каждого вашего действия.

[[bsdinstall-wireless-accesspoints]]
.Выбор беспроводной сети
image::bsdinstall-configure-wireless-accesspoints.png[]

Затем введите информацию о шифровании, применяемом для подключения к выбранной беспроводной сети.
Настоятельно рекомендуется использовать шифрование WPA2, а не старые менее безопасные способы, такие как WEP.
Если сеть использует WPA2, то введите пароль, который также называют PSK (Pre-Shared Key).
По соображениям безопасности символы, набираемые в поле ввода, отображаются в виде звёздочек.

[[bsdinstall-wireless-wpa2]]
.Настройка WPA2
image::bsdinstall-configure-wireless-wpa2setup.png[]

Затем выберите, требуется ли настройка адреса IPv4 для интерфейса Ethernet или беспроводного интерфейса:

[[bsdinstall-configure-net-ipv4]]
.Выберите настройку протокола IPv4
image::bsdinstall-configure-network-interface-ipv4.png[]

Существуют два способа настройки IPv4.
DHCP автоматически и корректно конфигурирует сетевой интерфейс, и должен использоваться, если в сети имеется сервер DHCP.
В противном случае информация об адресации должна быть введена вручную в виде статической конфигурации.

[NOTE]
====
Не вводите произвольные сетевые данные, так как это не сработает.
Если сервер DHCP недоступен, выясните перечисленную в <<bsdinstall-collect-network-information>> информацию у сетевого администратора или поставщика услуг Интернет.
====

Если сервер DHCP доступен, то для автоматической настройки сетевого интерфейса выберите btn:[Yes] в следующем меню.
В работе программы установки произойдёт пауза продолжительностью примерно в минуту, в течение которой будет выполняться поиск сервера DHCP и получение информации об адресации для системы.

[[bsdinstall-net-ipv4-dhcp]]
.Выбор настройки протокола IPv4 посредством DHCP
image::bsdinstall-configure-network-interface-ipv4-dhcp.png[]

Если сервер DHCP недоступен, то выберите btn:[No] и введите следующую информацию об адресации в этом меню:

[[bsdinstall-net-ipv4-static]]
.Статическая настройка IPv4 на сетевом интерфейсе
image::bsdinstall-configure-network-interface-ipv4-static.png[]

* `IP Address` - адрес IPv4, назначенный для этого компьютера. Этот адрес должен быть уникальным и не должен использоваться другим оборудованием в локальной сети.
* `Subnet Mask` - маска подсети, соответствующая данной сети.
* `Default Router` - адрес IP шлюза, используемого по умолчанию в данной сети.

На следующем экране будет отображён запрос на предмет необходимости настройки интерфейса на использование протокола IPv6.
Если IPv6 доступен и желателен, то выберите btn:[Yes] для подтверждения.

[[bsdinstall-net-ipv6]]
.Выберите настройку протокола IPv6 на сетевом интерфейсе
image::bsdinstall-configure-network-interface-ipv6.png[]

Для IPv6 также имеются два способа его настройки.
SLAAC (StateLess Address AutoConfiguration) в автоматическом режиме будет запрашивать информацию для корректной настройки у локального маршрутизатора.
Обратитесь к link:http://tools.ietf.org/html/rfc4862[http://tools.ietf.org/html/rfc4862] для получения дополнительной информации.
Статичная конфигурация требует ручного ввода сетевых параметров.

Если доступен маршрутизатор IPv6, то выберите btn:[Yes] в следюущем меню для автоматической настройки сетевого интерфейса.
В работе программы установки произойдёт пауза продолжительностью примерно в минуту, в течение которой будет выполняться поиск маршрутизатора и получение информации об адресации для системы.

[[bsdinstall-net-ipv6-slaac]]
.Выберите настройку протокола IPv6 посредством SLAAC
image::bsdinstall-configure-network-interface-slaac.png[]

Если маршрутизатор IPv6 недоступен, то выберите btn:[No] и введите следующую информацию об адресации в этом меню:

[[bsdinstall-net-ipv6-static]]
.Статичная настройка протокола IPv6
image::bsdinstall-configure-network-interface-ipv6-static.png[]

* `IPv6 Address` - адрес IPv6, который назначен этому компьютеру. Данный адрес должен быть уникальным и не должен быть уже использованным другим оборудованием в локальной сети.
* `Default Router` - адрес IPv6 маршрутизатора, используемого по умолчанию в этой сети.

Последнее меню настройки сети используется для настройки преобразователя имён DNS (Domain Name System), который выполняет преобразование имён хостов в сетевые адреса и наоборот, преобразование сетевых адресов в имена хостов.
Если для автоматической настройки сетевого интерфейса использовались механизмы DHCP или SLAAC, то значения параметров преобразователя имён могут быть уже указаны в разделе `Resolver Configuration`.
Если это не так, то введите название домена локальной сети в поле `Search`.
`DNS #1` и `DNS #2` являются адресами IPv4 и/или IPv6 серверов DNS.
Необходим по крайней мере один сервер.

[[bsdinstall-net-dns-config]]
.Настройка преобразователя имён DNS
image::bsdinstall-configure-network-ipv4-dns.png[]

[[bsdinstall-timezone]]
=== Настройка часового пояса

Последующий набор меню используется для корректного определения местного времени при помощи выбора географического региона, страны и часового пояса.
Указание часового пояса позволяет системе автоматически подстраиваться под такие изменения в региональных параметрах времени, как переходы на летнее время, а также выполнять другие функции, связанные с часовыми поясами, без нареканий.

Приводимый здесь пример подходит для машины, находящейся в материковом часовом поясе Испании в Европе.
Выбор будет отличаться в зависимости от географического местоположения.

[[bsdinstall-timezone-region]]
.Выберите регион
image::bsdinstall-timezone-region.png[]

Соответствующий регион выбирается при помощи клавиш навигации и подтверждается нажатием клавиши kbd:[Enter].

[[bsdinstall-timezone-country]]
.Выберите страну
image::bsdinstall-timezone-country.png[]

Выберите необходимую страну при помощи клавиш навигации и подтвердите выбор клавишей kbd:[Enter].

[[bsdinstall-timezone-zone]]
.Выберите часовой пояс
image::bsdinstall-timezone-zone.png[]

Соответствующий часовой пояс выбирается клавишами навигации и подтверждается нажатием клавиши kbd:[Enter].

[[bsdinstall-timezone-confirmation]]
.Подтверждение выбора часового пояса
image::bsdinstall-timezone-confirm.png[]

Подтвердите корректность выбора аббревиатуры для часового пояса.

[[bsdinstall-timezone-date]]
.Выберите дату
image::bsdinstall-timezone-date.png[Выберите дату]

Подходящая дата выбирается с помощью клавиш навигации с последующим нажатием btn:[Set Date].
Либо выбор даты может быть пропущен нажатием btn:[Skip].

[[bsdinstall-timezone-time]]
.Выберите время
image::bsdinstall-timezone-time.png[Выберите время]

Подходящее время выбирается с помощью клавиш навигации с последующим нажатием btn:[Set Time].
Либо выбор времени может быть пропущен нажатием btn:[Skip].

[[bsdinstall-sysconf]]
=== Активирование сервисов

Следующее меню используется для указания системных сервисов, которые будут запущены при загрузке системы.
Все эти сервисы являются необязательными.
Запускайте только те сервисы, что необходимы для работы системы.

[[bsdinstall-config-serv]]
.Выбор дополнительных активируемых сервисов
image::bsdinstall-config-services.png[]

Вот краткое описание сервисов, которые могут быть активированы в данном меню:

* `local_unbound` - Активирует локальный unbound для сервиса DNS. Необходимо помнить, что это unbound из базовой поставки, который применим только в качестве локального кэширующего и перенаправляющего запросы сервиса преобразования имён. Если целью является настройка преобразователя имён для всей сети, установите package:dns/unbound[].
* `sshd` - Даемон Secure Shell (SSH) используется для дистанционного доступа в систему с использованием зашифрованного соединения.  Активируйте этот сервис только если система должна быть доступна для входа в неё в дистанционном режиме.
* `moused` - Включите этот сервис, если на системной консоле в режиме командной строки будет использоваться мышь.
* `ntpdate` - Включает автоматическую синхронизацию времени во время загрузки. Функциональность данной программы в настоящее время доступна в даемоне man:ntpd[8]. После подобающего периода скорби утилита man:ntpdate[8] будет отправлена в отставку.
* `ntpd` - Даемон Network Time Protocol (NTP) для автоматической синхронизации времени.  Активируйте этот сервис, если в сети присутствует сервер Windows(R), Kerberos или LDAP.
* `powerd` - Системная утилита для контроля потребляемой мощности и профилей энергосбережения.
* `dumpdev` - Активация создания аварийных образов системы полезна при устранении неполадок системы, поэтому пользователи призываются к включению функции создания её аварийных образов.

[[bsdinstall-hardening]]
=== Активация усиленных средств безопасности

Следующее меню используется для настройки того, какие параметры безопасности будут активированы.
Все из этих вариантов являются необязательными.
Однако их использование поощряется.

[[bsdinstall-hardening-options]]
.Выбор усиленных параметров безопасности
image::bsdinstall-hardening.png[Выбор усиленных параметров безопасности]

Вот краткий обзор параметров, которые могут быть активированы в данном меню:

* `hide_uids` - Скрывать процессы, работающие с полномочиями других пользователей, ограничивая просмотр непривилегированными пользователями процессов, работающих с полномочиями других пользователей (UID), для предотвращения утечки информации.
* `hide_gids` - Скрывать процессы, работающие с полномочиями других групп пользователей, ограничивая просмотр непривилегированными пользователями процессов, работающих с полномочиями других групп пользователей (GID), для предотвращения утечки информации.
* `hide_jail` - Скрывать процессы, работающие в изоляторах, ограничивая просмотр непривилегированными пользователями процессов, работающих в изоляторах.
* `read_msgbuf` - Отключение функции чтения буфера сообщений ядра непривилегированными пользователями, ограничивая использование man:dmesg[8] для просмотра сообщений из буфера журнала ядра.
* `proc_debug` - Отключение функций отладки процессов для непривилегированных пользователей, что приводит к отключению различных непривилегированных сервисов межпроцессной отладки, в том числе часть функциональности procfs, ptrace() и ktrace(). Пожалуйста, обратите внимание, что это также ограничивает работу инструментов отладки, к примеру, man:lldb[1], man:truss[1], man:procstat[1], а также некоторых встроенных средств отладки в определённых скриптовых языках программирования, подобных PHP и других, в режиме непривилегированных пользователей.
* `random_pid` - Случайный выбор PID для вновь создаваемых процессов.
* `clear_tmp` - Очистка [.filename]#/tmp# при загрузке системы.
* `disable_syslogd` - Отключение открытие сетевого порта syslogd. По умолчанию FreeBSD запускает syslogd в безопасном режиме с параметром `-s`. Это не позволяет даемону получать информацию о входящих UDP-запросах на порту 514. При включении данного параметра syslogd будет запускаться с параметром `-ss`, который не позволяет syslogd открывать какие бы то ни было порты. Для получения более полной информации обратитесь к man:syslogd[8].
* `disable_sendmail` - Отключение почтового транспортного агента sendmail.
* `secure_console` - При включении этого параметра системное приглашение будет требовать ввода пароля пользователя root при переходе в однопользовательский режим.
* `disable_ddtrace - DTrace может работать в режиме, который будет влиять на работающее ядро. Деструктивные действия не могут быть выполнены, если только они не разрешены явным образом. Для включения этого параметра при использовании DTrace воспользуйтесь параметром `-w`. Для получения дополнительной информации обратитесь к man:dtrace[1].

[[bsdinstall-addusers]]
=== Добавление пользователей

В следующем меню запрашивается создание по крайней мере одной пользовательской учётной записи.
Рекомендуется выполнять вход в систему с использованием пользовательской учётной записи, а не `root`. Работа в системе с правами пользователя `root` особенна тем, что по существу нет ограничений или защиты от действий пользователя. Вход под обычным пользователем является более благоразумным и безопасным.

Для добавления новых пользователей выберите btn:[Yes].

[[bsdinstall-add-user1]]
.Добавление пользовательских учетных записей
image::bsdinstall-adduser1.png[]

Следуйте указаниям и введите запрашиваемую информацию об учётной записи.
Пример, показанный в <<bsdinstall-add-user2>>, создаёт учётную запись `asample`.

[[bsdinstall-add-user2]]
.Ввод информации о пользователе
image::bsdinstall-adduser2.png[]

Вот краткое описание вводимой информации:

* `Username` - Имя, которое будет вводить пользователь для входа в систему.  Популярной практикой является использование первой буквы имени и фамилии, при этом в системе все имена пользователей должны быть уникальными.  Имя пользователя чувствительно к регистру и не должно содержать пробелов.

 Часто оно формируется из объединенных вместе первой буквы имени и фамилии.
* `Full name` - Полное имя пользователя.  Оно может содержать пробелы и используется в качестве описания учётной записи пользователя.
* `Uid` - Идентификатор пользователя. Обычно это поле не заполняется, система сама присвоит ему значение.
* `Login group` - Имя группы для этого пользователя.  Обычно это поле остаётся незаполненным для того, чтобы использовать значение по умолчанию.
* `Invite _user_ into other groups?` - Дополнительные группы, в которые будет включён пользователь.  Если пользователю необходим административный доступ, наберите здесь `wheel`.
* `Login class` - Обычно оставляется пустым для принятия значения по умолчанию.
* `Shell` - Введите одно из перечисленных значений для установки интерактивной оболочки командной строки для этого пользователя.  Обратитесь к <<shells>> для получения дополнительной информации о командных процессорах.
* `Home directory` - Домашний каталог пользователя. Как правило, значение по умолчанию является корректным.
* `Home directory permissions` - Права на домашний каталог пользователя. Значение по умолчанию является корректным в большинстве случаев.
* `Use password-based authentication?` - Обычно `yes`, чтобы у пользователей запрашивался пароль при входе в систему.
* `Use an empty password?` - Обычно `no`, так как использование пустого пароля небезопасно.
* `Use a random password?` - Обычно `no`, при этом пользователь может установить собственный пароль на последующем шаге.
* `Enter password` - Пароль для этого пользователя.  Набираемые символы не будут отображаться на экране.
* `Enter password again` - Пароль необходимо ввести еще раз (для сверки).
* `Lock out the account after creation?` - Обычно `no`, чтобы пользователь мог входить в систему.

После завершения ввода отображается краткий свод для проверки.
Если была допущена ошибка, то введите `no` и попробуйте ещё раз.
Если всё корректно, то введите `yes` для создания новой учётной записи пользователя.

[[bsdinstall-add-user3]]
.Заполненная форма ввода информации о новом пользователе
image::bsdinstall-adduser3.png[]

Ответьте `yes` на вопрос `Add another user?`, если нужно создать дополнительных пользователей.
Для завершения добавления пользователей и продолжения послеустановочной настройки выберите `no`.

За более детальной информацией об управлении учетными записями обратитесь к crossref:basics[users-synopsis,Пользователи и основы управления учетными записями].

[[bsdinstall-final-conf]]
=== Завершение настройки

После того, как установка и конфигурирование завершены, вам предоставляется заключительная возможность подкорректировать настройки.

[[bsdinstall-final-config]]
.Финальное конфигурационное меню
image::bsdinstall-finalconfiguration.png[]

Используйте это меню для внесения любых изменений или для выполнения дополнительного конфигурирования перед завершением установки.

* `Add User` - Описывается в <<bsdinstall-addusers>>.
* `Root Password` - Описывается в <<bsdinstall-post-root>>.
* `Hostname` - Описывается в <<bsdinstall-hostname>>.
* `Network` - Описывается в <<bsdinstall-config-network-dev>>.
* `Services` - Описывается в <<bsdinstall-sysconf>>.
* `System Hardening` - Описывается в <<bsdinstall-hardening>>.
* `Time Zone` - Описывается в <<bsdinstall-timezone>>.
* `Handbook` - Загрузка и установка Руководства FreeBSD.

После завершения любых настроек выбирайте btn:[Exit].

[[bsdinstall-final-modification-shell]]
.Ручная настройка
image::bsdinstall-final-modification-shell.png[]

bsdinstall уточнит, есть ли какие настройки, которые необходимо выполнить до перезагрузки в свежеустановленную систему.
Для входа в командный интерпретатор новой системы выберите btn:[Yes], а для перехода к последнему шагу установки нажмите btn:[No].

[[bsdinstall-final-main]]
.Завершение установки
image::bsdinstall-mainexit.png[]

Если требуется дополнительная настройка или особая конфигурация, выберите btn:[Live CD] для загрузки с установочного носителя в режиме Live CD.

Если установка завершена, для перезагрузки компьютера и запуска новой системы FreeBSD выберите btn:[Reboot].
Не забудьте извлечь установочный носитель FreeBSD, иначе компьютер может снова с него загрузиться.

Во время загрузки FreeBSD отображаются информационные сообщения.
После завершения загрузки системы будет отображено приглашение к входу.
В приглашении `login:` введите имя пользователя, добавленного при установке.
Избегайте входа в систему как `root`.
Обратитесь к <<users-superuser>> за указаниями о том, как стать суперпользователем, когда необходим административный доступ.

Сообщения, которые появлялись во время загрузки, могут быть просмотрены после нажатия kbd:[Scroll-Lock], которое включает режим _буфера прокрутки_.
Клавиши kbd:[PgUp], kbd:[PgDn], а также клавиши навигации могут быть задействованы для прокрутки сообщений.
После завершения просмотра нажмите kbd:[Scroll-Lock] повторно, чтобы разблокировать дисплей и вернуться в консоль.
Для просмотра этих сообщений после того, как система уже поработала какое-то время, наберите `less /var/run/dmesg.boot` в командной строке.
Для возврата к командной строке после просмотра сообщений нажмите kbd:[q].

Если в <<bsdinstall-config-serv>> был активирован sshd, то первая загрузка может выполняться несколько медленнее, так как система будет формировать ключи RSA и DSA.
Последующие загрузки будут осуществляться быстрее.
Отпечатки этих ключей будут отображаться так, как показано в этом примере:





[source,shell]
....
Generating public/private rsa1 key pair.
Your identification has been saved in /etc/ssh/ssh_host_key.
Your public key has been saved in /etc/ssh/ssh_host_key.pub.
The key fingerprint is:
10:a0:f5:af:93:ae:a3:1a:b2:bb:3c:35:d9:5a:b3:f3 root@machine3.example.com
The key's randomart image is:
+--[RSA1 1024]----+
|    o..          |
|   o . .         |
|  .   o          |
|       o         |
|    o   S        |
|   + + o         |
|o . + *          |
|o+ ..+ .         |
|==o..o+E         |
+-----------------+
Generating public/private dsa key pair.
Your identification has been saved in /etc/ssh/ssh_host_dsa_key.
Your public key has been saved in /etc/ssh/ssh_host_dsa_key.pub.
The key fingerprint is:
7e:1c:ce:dc:8a:3a:18:13:5b:34:b5:cf:d9:d1:47:b2 root@machine3.example.com
The key's randomart image is:
+--[ DSA 1024]----+
|       ..     . .|
|      o  .   . + |
|     . ..   . E .|
|    . .  o o . . |
|     +  S = .    |
|    +  . = o     |
|     +  . * .    |
|    . .  o .     |
|      .o. .      |
+-----------------+
Starting sshd.
....

Обратитесь к <<openssh>> для получения дополнительной информации об отпечатках и SSH.

По умолчанию во FreeBSD не выполняется установка графического окружения.
Обратитесь к <<x11>> за дополнительной информацией об установке и настройке графического оконного менеджера.

Корректное завершение работы компьютера с FreeBSD помогает защитить от повреждений данные и оборудование.
_Не выключайте электропитание до полного завершения работы системы!_
Если ваш пользователь входит в группу `wheel`, то перейдите в режим суперпользователя, набрав в командной строке команду `su` и введя пароль пользователя `root`.
Затем наберите команду `shutdown -p now`, после чего система корректно завершит работу и, если оборудование это поддерживает, выключится.

[[bsdinstall-install-trouble]]
== Решение проблем

Этот раздел описывает базовые приёмы устранения распространённых проблем, возникающих при установке и о которых часто сообщают пользователи.

Просмотрите Информацию об оборудовании (link:https://www.FreeBSD.org/releases/index.html[https://www.FreeBSD.org/releases/index.html] для соответствующей версии FreeBSD, чтобы убедиться, что оборудование поддерживается.
Если оборудование поддерживается, но происходят зависания или проявляются другие проблемы, постройте собственное ядро в соответствии с инструкциями в главе <<kernelconfig>> для того, чтобы добавить поддержку устройств, отсутствующих в ядре [.filename]#GENERIC#.
Стандартное ядро предполагает, что настройки большинства устройств соответствуют заводским параметрам, используемым по умолчанию для задания прерываний, адресов ввода/вывода и каналов DMA.
Если оборудование было перенастроено, то нестандартный файл конфигурации ядра укажет FreeBSD на его параметры.

[NOTE]
====
Некоторое количество проблем с установкой может быть устранено или уменьшено путем обновления встроенного программного обеспечения различных аппаратных компонентов, особенно - материнской платы. Встроенное программное обеспечение материнской платы обычно называется BIOS. У большинства производителей материнских плат и компьютеров есть Web-сайты, содержащие как информацию об обновлениях, так и сами обновления.

В общем, производители не рекомендуют обновлять BIOS материнской платы, если на то нет веских причин, например, таких как появление критически важного обновления. Процесс обновления _может_ потерпеть неудачу, тем самым оставив BIOS поврежденным, а компьютер - нерабочим.
====

Если система зависает во время загрузки на этапе обнаружения устройств, либо она ведёт себя странно во время установки, то причиной может быть ACPI.
FreeBSD широко использует системные сервисы ACPI на платформах i386 и amd64 в качестве вспомогательных при конфигурировании оборудования, если такие сервисы обнаруживаются во время загрузки.
К сожалению, до сих пор существуют неполадки как в драйвере ACPI, так и среди материнских плат и их BIOS.
ACPI может быть отключена путём установки значения переменной `hint.acpi.0.disabled` на третьем этапе загрузки:

[source,shell]
....
 set hint.acpi.0.disabled="1"
....

Это значение сбрасывается каждый раз при загрузке системы, поэтому строку `hint.acpi.0.disabled="1"` необходимо добавить в файл [.filename]#/boot/loader.conf#. Информация о загрузчике приведена в crossref:boot[boot-synopsis,Описание].

[[using-live-cd]]
== Использование Live CD

Приветственное меню bsdinstall, показанное в <<bsdinstall-choose-mode>>, содержит вариант btn:[Live CD].
Он удобен для тех пользователей, которые всё еще размышляют о том, насколько FreeBSD будет для них правильным выбором и желают проверить некоторые функциональные возможности до её установки.

До перехода к использованию варианта btn:[Live CD] необходимо отметить следующее:

* Для получения доступа к системе необходимо осуществить аутентификацию. Имя пользователя - `root`, пароль отсутствует.
* Так как система работает непосредственно с установочного носителя, её производительность будет существенно ниже системы, установленной на жёсткий диск.
* В этом варианте предоставляется только интерфейс командной строки, графический интерфейс отсутствует.
